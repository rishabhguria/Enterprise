<?xml version="1.0" encoding="UTF-8"?>
<!--
This file was generated by Altova MapForce 2007

YOU SHOULD NOT MODIFY THIS FILE, BECAUSE IT WILL BE
OVERWRITTEN WHEN YOU RE-RUN CODE GENERATION.

Refer to the Altova MapForce 2007 Documentation for further details.
http://www.altova.com/mapforce
-->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/2001/XMLSchema" exclude-result-prefixes="xs">
	<xsl:output method="xml" encoding="UTF-8" indent="yes"/>
	
	<xsl:template match="/ThirdPartyFlatFileDetailCollection">
		
		<ThirdPartyFlatFileDetailCollection>
			
			<xsl:attribute name="xsi:noNamespaceSchemaLocation">C:/UpdatedTP/Prana_Final.xsd</xsl:attribute>
			
			<xsl:for-each select="ThirdPartyFlatFileDetail">
				
				<ThirdPartyFlatFileDetail>

					<GroupAllocationReq>
						<xsl:value-of select ="'true'"/>
					</GroupAllocationReq>
					
					<FileHeader>
						<xsl:value-of select ="'true'"/>
					</FileHeader>
					
					<FileFooter>
						<xsl:value-of select ="'true'"/>
					</FileFooter>
					
					<RowHeader>
						<xsl:value-of select ="'false'"/>
					</RowHeader>
					
					<TaxlotState>
						<xsl:value-of select ="TaxLotState"/>
					</TaxlotState>

					<PBUniqueID>
						<xsl:value-of select ="PBUniqueID"/>
					</PBUniqueID>

					<Record_Identifier>
						<xsl:value-of select="'OR'"/>
					</Record_Identifier>

					<Block_Order_Id>
						<xsl:value-of select="PBUniqueID"/>
					</Block_Order_Id>

					<Client_Identifier>
						<xsl:value-of select ="'Lyrical'"/>
					</Client_Identifier>

					<xsl:variable name="varTradeDate">
						<xsl:value-of select="concat(substring-after(substring-after(TradeDate,'/'),'/'),substring-before(TradeDate,'/'),substring-before(substring-after(TradeDate,'/'),'/'))"/>
					</xsl:variable>					

					<TradeDate>
						<xsl:value-of select="$varTradeDate"/>
					</TradeDate>

					<xsl:variable name="varSettlementDate">
						<xsl:value-of select="concat(substring-after(substring-after(SettlementDate,'/'),'/'),substring-before(SettlementDate,'/'),substring-before(substring-after(SettlementDate,'/'),'/'))"/>
					</xsl:variable>

					<SettlementDate>
						<xsl:value-of select="$varSettlementDate"/>
					</SettlementDate>

					<xsl:variable name="varSide">
						<xsl:value-of select="substring(Side,1,1)"/>
					</xsl:variable>

					<Side>
						<xsl:value-of select="$varSide"/>
					</Side>

					<SecurityID_Type>
						<xsl:value-of select ="'A'"/>
					</SecurityID_Type>

					<SecurityID>
						<xsl:value-of select ="Symbol"/>
					</SecurityID>

					<Suffix>
						<xsl:value-of select ="''"/>
					</Suffix>					

					<Shares_1>
						<xsl:value-of select="ExecutedQty"/>
					</Shares_1>

					<AveragePrice>
						<xsl:value-of select="AveragePrice"/>
					</AveragePrice>

					<Solicited_UnSolicited_Code>
						<xsl:value-of select="'U'"/>
					</Solicited_UnSolicited_Code>

					<CommissionType_1>
						<xsl:value-of select="'4'"/>
					</CommissionType_1>

					<CommissionAmount_1>
						<xsl:value-of select="0"/>
					</CommissionAmount_1>

					<Step_IN_Indicator>
						<xsl:value-of select="''"/>
					</Step_IN_Indicator>

					<Open_Close_Indicator>
						<xsl:value-of select="''"/>
					</Open_Close_Indicator>

					<Covered_Uncovered_indicator>
						<xsl:value-of select="''"/>
					</Covered_Uncovered_indicator>
					
					
					<GroupEnds>
						<xsl:value-of select ="'GroupEnds'"/>
					</GroupEnds>
					
					

					<Record_Identifier_1>
						<xsl:value-of select ="'AR'"/>
					</Record_Identifier_1>

					<Block_Order_Id_1>
						<xsl:value-of select ="PBUniqueID"/>
					</Block_Order_Id_1>

					<Allocation_Id>
						<xsl:value-of select ="EntityID"/>
					</Allocation_Id>

					<AccountNumber>
						<xsl:value-of select="AccountNo"/>
					</AccountNumber>

					<Account_Type>
						<xsl:value-of select="'0'"/>
					</Account_Type>

					<AccountRR>
						<xsl:value-of select="''"/>
					</AccountRR>

					<Shares>
						<xsl:value-of select ="AllocatedQty"/>
					</Shares>

					<CommissionType>
						<xsl:value-of select ="'4'"/>
					</CommissionType>

					<CommissionAmount>
						<xsl:value-of select ="0"/>
					</CommissionAmount>

					<Versus_PurchaseDate>
						<xsl:value-of select ="''"/>
					</Versus_PurchaseDate>

					<StepOutIndicator>
						<xsl:value-of select ="''"/>
					</StepOutIndicator>

					<StepoutBroker>
						<xsl:value-of select ="''"/>
					</StepoutBroker>

					<EntityID>
						<xsl:value-of select="EntityID"/>
					</EntityID>					

				</ThirdPartyFlatFileDetail>
			</xsl:for-each>
		</ThirdPartyFlatFileDetailCollection>
	</xsl:template>
</xsl:stylesheet>
