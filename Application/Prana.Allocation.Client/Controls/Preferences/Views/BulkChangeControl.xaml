<Window x:Name="BulkChangeWindow" xmlns:ig="http://schemas.infragistics.com/xaml"  
             xmlns:igWPF="http://schemas.infragistics.com/xaml/wpf"  
             x:Class="Prana.Allocation.Client.Controls.Preferences.Views.BulkChangeControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:viewModels="clr-namespace:Prana.Allocation.Client.Controls.Preferences.ViewModels"
             xmlns:behaviours="clr-namespace:Prana.Allocation.Client.Behaviours"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:Core="clr-namespace:System;assembly=mscorlib"
             xmlns:shell="http://schemas.microsoft.com/winfx/2006/xaml/presentation/shell"
             xmlns:customChromeLibrary="clr-namespace:Prana.CustomChromeLibrary;assembly=Prana.CustomChromeLibrary"
             mc:Ignorable="d" 
             Title="Bulk Change Form"
             WindowStartupLocation="CenterOwner"
             ShowInTaskbar="False"
             WindowState="{Binding Path=BringToFront, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
             DataContext="{DynamicResource BulkChangeControlViewModel}" Width="400" Height="450" SizeToContent="Manual">
    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Prana.Allocation.Client;component/NirvanaSkin.xaml"/>
                <igWPF:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <igWPF:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamComboEditor.xaml" />
                    </igWPF:ResourceWasher.SourceDictionary>
                </igWPF:ResourceWasher>
                <igWPF:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <igWPF:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamDockManager.xaml" />
                    </igWPF:ResourceWasher.SourceDictionary>
                </igWPF:ResourceWasher>
                <igWPF:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <igWPF:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamEditors.xaml" />
                    </igWPF:ResourceWasher.SourceDictionary>
                </igWPF:ResourceWasher>
                <igWPF:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <igWPF:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamGrid.xaml" />
                    </igWPF:ResourceWasher.SourceDictionary>
                </igWPF:ResourceWasher>
                <igWPF:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <igWPF:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMenu.xaml" />
                    </igWPF:ResourceWasher.SourceDictionary>
                </igWPF:ResourceWasher>
                <igWPF:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <igWPF:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMultiColumnCombo.xaml" />
                    </igWPF:ResourceWasher.SourceDictionary>
                </igWPF:ResourceWasher>

            </ResourceDictionary.MergedDictionaries>
            <viewModels:BulkChangeControlViewModel x:Key="BulkChangeControlViewModel"/>
            <Style  x:Key="DateEditorStyle" TargetType="{x:Type igWPF:XamNumericEditor}">
                <Setter Property="IsEnabled" Value="False"></Setter>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Prorata">
                        <Setter Property="IsEnabled" Value="True"></Setter>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
            <Style  x:Key="AccountListStyle" TargetType="{x:Type ig:XamComboEditor}" BasedOn="{StaticResource igXamComboEditorStyle}">
                <Setter Property="IsEnabled" Value="False"></Setter>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Prorata">
                        <Setter Property="IsEnabled" Value="True"></Setter>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Leveling">
                        <Setter Property="IsEnabled" Value="True"></Setter>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Pro-rata (NAV)">
                        <Setter Property="IsEnabled" Value="True"></Setter>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
            <Style  x:Key="AllocationMethodStyle" TargetType="{x:Type ComboBox}">
                <Setter Property="IsEnabled" Value="{Binding Path=IsAllocationMethod, Mode=TwoWay}"></Setter>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Prorata">
                        <Setter Property="IsEnabled" Value="False"></Setter>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Leveling">
                        <Setter Property="IsEnabled" Value="False"></Setter>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Pro-rata (NAV)">
                        <Setter Property="IsEnabled" Value="False"></Setter>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
            <Style  x:Key="AllocationMethodCheckBoxStyle" TargetType="{x:Type CheckBox}">
                <Setter Property="IsEnabled" Value="True"></Setter>
                <Setter Property="IsChecked" Value="{Binding Path=IsAllocationMethod, Mode=TwoWay}"></Setter>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Prorata">
                        <Setter Property="IsChecked" Value="True"></Setter>
                        <Setter Property="IsEnabled" Value="False"></Setter>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Leveling">
                        <Setter Property="IsChecked" Value="True"></Setter>
                        <Setter Property="IsEnabled" Value="False"></Setter>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding ElementName=cmbboxTargetPercentage, Path=SelectedItem.DisplayText}" Value="Pro-rata (NAV)">
                        <Setter Property="IsChecked" Value="True"></Setter>
                        <Setter Property="IsEnabled" Value="False"></Setter>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </Window.Resources>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Loaded">
            <i:InvokeCommandAction Command="{Binding Path=BulkChangeControlViewLoadedCommand }"/>
        </i:EventTrigger>
        <i:EventTrigger EventName="Closing">
            <i:InvokeCommandAction Command="{Binding Path=CloseBulkChangeUI }"/>
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <shell:WindowChrome.WindowChrome>
        <shell:WindowChrome
            ResizeBorderThickness="6"
            CaptionHeight="22"
            CornerRadius="5"
            GlassFrameThickness="0"/>
    </shell:WindowChrome.WindowChrome>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="auto" />
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--provide the background for the entire form.  In practice, this appears as the window's resize border, because the title and window content obscure the rest-->
        <Border CornerRadius="2" Grid.RowSpan="2" BorderThickness="5" BorderBrush="#FF212C39" Background="#FFD1D2D4"/>

        <!--title bar-->
        <Border CornerRadius="2" BorderThickness="1" BorderBrush="#FF212C39" Background="#FF212C39">
            <!--Window Icon and Title-->
            <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Left">
                <TextBlock Height="22" Margin="5,0,0,0" Foreground="#FFD1D2D4" VerticalAlignment="Center">
                    <TextBlock.Style>
                        <Style TargetType="{x:Type TextBlock}">
                            <Setter Property="FontSize" Value="15"/>
                            <Setter Property="Text" Value="Nirvāna"/>
                            <Setter Property="FontFamily" Value="Mulish"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding BringToFront}" Value="Minimized">
                                    <Setter Property="FontSize" Value="12"/>
                                    <Setter Property="Text" Value="Bulk Change"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </StackPanel>

        </Border>

        <StackPanel Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Right">
            <TextBlock Text="Bulk Change" Height="22" FontSize="15" Foreground="#FF8ABB54" VerticalAlignment="Center" HorizontalAlignment="Center">
                <TextBlock.Style>
                    <Style TargetType="{x:Type TextBlock}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding BringToFront}" Value="Minimized">
                                <Setter Property="Text" Value=""/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </TextBlock.Style>
            </TextBlock>
            <customChromeLibrary:CaptionButtons  VerticalAlignment="Center"/>
        </StackPanel>
        <!--min/max/close buttons-->

        <!--Content-->
        <Grid Grid.Row="1">
            <Grid Margin="5">
                <GroupBox Name="gboxBulkChange" Header="Bulk Changes on Allocation Rule" Margin="5,5,5,5" BorderBrush="{DynamicResource GroupBoxBorder}">
                    <Grid Margin="5">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>                        
                        <Grid Grid.Row="1" Margin="5" Width="400">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Name="chkboxApplyOnDefaultRule" Content="Apply on Default Rule" Grid.Row="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" IsChecked="{Binding Path=IsDefaultRule}"/>
                            <CheckBox x:Name="chkboxSelectedPrefs" Content="Apply on selected Preferences" Grid.Row="1" Grid.Column="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" IsChecked="{Binding Path=IsSelectedPreference, Mode=TwoWay}"/>
                            <ig:XamComboEditor Name="cmbboxSelectedPrefs" ToolTip="{Binding SelectedValues, ElementName=ComboEditorBehavior}" IsEditable="True" AllowMultipleSelection="True" CheckBoxVisibility="Visible" Grid.Row="1" Grid.Column="1" Width="120" Margin="5" HorizontalAlignment="Left" VerticalAlignment="Center" ItemsSource="{Binding Path=AllocationPreferenceCollection}" DisplayMemberPath="Value" IsEnabled="{Binding Path=IsSelectedPreference, Mode=TwoWay}" EmptyText="Select">
                                <ig:XamComboEditor.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Value}" ToolTip="{Binding Value}" Width="100"/>
                                    </DataTemplate>
                                </ig:XamComboEditor.ItemTemplate>
                                <i:Interaction.Behaviors>
                                    <behaviours:XamComboEditorBehavior x:Name="ComboEditorBehavior" SelectedItems="{Binding Path=SelectedAllocationPreferences, Mode=TwoWay}" />
                                </i:Interaction.Behaviors>
                            </ig:XamComboEditor>
                            <Separator Grid.Row="2" Grid.ColumnSpan="2" Grid.Column="0" Width="Auto"/>
                            <CheckBox Name="chkboxAllocationMethod" Content="Allocation Method" Grid.Row="3" Grid.Column="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Style="{StaticResource AllocationMethodCheckBoxStyle}"/>
                            <ComboBox Name="cmbboxAllocationMethod" ToolTip="{Binding SelectedItem.DisplayText, RelativeSource={RelativeSource Self}}" IsEditable="True" IsReadOnly="True" Grid.Row="3" Grid.Column="1" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Width="120" ItemsSource="{Binding Path=AllocationTypeCollection}" SelectedItem="{Binding Path=SelectedAllocationType}" DisplayMemberPath="DisplayText" IsSynchronizedWithCurrentItem="True" Template="{DynamicResource ComboBoxEditableTemplate}" Style="{StaticResource AllocationMethodStyle}">
                                <ComboBox.ItemContainerStyle>
                                    <Style>
                                        <Setter Property="Control.ToolTip" Value="{Binding DisplayText}" />
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                            </ComboBox>
                            <CheckBox Name="chkboxRemainderAllocation" Content="Remainder Allocation to" Grid.Row="4" Grid.Column="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" IsChecked="{Binding Path=IsRemainderAllocation, Mode=TwoWay}"/>
                            <ComboBox Name="cmbboxRemainderAllocation" ToolTip="{Binding SelectedItem.Value, RelativeSource={RelativeSource Self}}" IsEditable="True" IsReadOnly="True" Grid.Row="4" Grid.Column="1" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Width="120" IsEnabled="{Binding Path=IsRemainderAllocation}" SelectedItem="{Binding Path=SelectedRemainderAllocationAccount}" ItemsSource="{Binding Path=Accounts}" DisplayMemberPath="Value" IsSynchronizedWithCurrentItem="True" Template="{DynamicResource ComboBoxEditableTemplate}">
                                <ComboBox.ItemContainerStyle>
                                    <Style>
                                        <Setter Property="Control.ToolTip" Value="{Binding Value}" />
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                            </ComboBox>
                            <CheckBox Name="chkboxTargetPercent" Content="Target % as of" Grid.Row="5" Grid.Column="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" IsChecked="{Binding Path=IsTargetPercent, Mode=TwoWay}"/>
                            <ComboBox Name="cmbboxTargetPercentage" ToolTip="{Binding SelectedItem.DisplayText, RelativeSource={RelativeSource Self}}" IsEditable="True" IsReadOnly="True" Grid.Row="5" Grid.Column="1" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Width="120" IsEnabled="{Binding Path=IsTargetPercent}" ItemsSource="{Binding Path=MatchingRuleTypeCollection}" SelectedItem="{Binding Path=SelectedMatchingRuleType}" DisplayMemberPath="DisplayText" IsSynchronizedWithCurrentItem="True" Template="{DynamicResource ComboBoxEditableTemplate}">
                                <ComboBox.ItemContainerStyle>
                                    <Style>
                                        <Setter Property="Control.ToolTip" Value="{Binding DisplayText}" />
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                            </ComboBox>
                            <CheckBox Name="chkboxMatchClosingTrasaction" Content="Match closing trasactions exactly" Grid.Row="6" Grid.Column="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" IsChecked="{Binding Path=IsMatchClosingTransaction, Mode=TwoWay}"/>
                            <ComboBox Name="cmbboxMatchClosingTransaction" ToolTip="{Binding SelectedItem.DisplayText, RelativeSource={RelativeSource Self}}" IsEditable="True" IsReadOnly="True" Grid.Row="6" Grid.Column="1" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Width="120" IsEnabled="{Binding Path=IsMatchClosingTransaction}" ItemsSource="{Binding Path=MatchClosingCollection}" SelectedItem="{Binding Path=SelectedMatchClosing}" DisplayMemberPath="DisplayText" IsSynchronizedWithCurrentItem="True" Template="{DynamicResource ComboBoxEditableTemplate}">
                                <ComboBox.ItemContainerStyle>
                                    <Style>
                                        <Setter Property="Control.ToolTip" Value="{Binding DisplayText}" />
                                    </Style>
                                </ComboBox.ItemContainerStyle>
                            </ComboBox>
                            <Label Name="lblProrataAccounts" Content="Accounts for Prorata/Leveling" Grid.Row="7" Grid.Column="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                            <ig:XamComboEditor Name="cmbboxProrataAccounts" ToolTip="{Binding SelectedValues, ElementName=XamComboEditorBehavior}" IsEditable="True" Grid.Row="7" AllowMultipleSelection="True" CheckBoxVisibility="Visible" Grid.Column="1" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center" Width="120" ItemsSource="{Binding Path=Accounts}" DisplayMemberPath="Value" Style="{StaticResource AccountListStyle}">
                                <ig:XamComboEditor.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Value}" ToolTip="{Binding Value}" Width="100"/>
                                    </DataTemplate>
                                </ig:XamComboEditor.ItemTemplate>
                                <i:Interaction.Behaviors>
                                    <behaviours:XamComboEditorBehavior x:Name="XamComboEditorBehavior" SelectedItems ="{Binding Path=SelectedAccount, Mode=TwoWay}"/>
                                </i:Interaction.Behaviors>
                            </ig:XamComboEditor>
                            <Label Name="lblDateUptoDays" Content="Date up to days" Grid.Row="8" Grid.Column="0" Margin="5,5,5,5" HorizontalAlignment="Left" VerticalAlignment="Center"/>
                            <igWPF:XamNumericEditor Name="txtboxDateUptoDays"  HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,5,5,5" Grid.Row="8" Grid.Column="1" Width="120" SpinButtonDisplayMode="Always" PromptChar=" " ValueType="Core:Int32" Value="{Binding Path=DateUptoDays}" Style="{StaticResource DateEditorStyle}">
                                <igWPF:XamNumericEditor.ValueConstraint>
                                    <igWPF:ValueConstraint MinInclusive="0"/>
                                </igWPF:XamNumericEditor.ValueConstraint>
                            </igWPF:XamNumericEditor>
                        </Grid>
                        <Button Name="btnApply" Content="Apply" VerticalAlignment="Center" Margin="5" Grid.Row="2" Width="100" Template="{DynamicResource ButtonControlTemplate}" Foreground="{DynamicResource ButtonForeground}">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Click">
                                    <i:InvokeCommandAction Command="{Binding Path=ApplyPreferenceBulkChangeCommand }" CommandParameter="{Binding ElementName=BulkChangeWindow}"/>
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </Button>
                    </Grid>
                </GroupBox>
            </Grid>
        </Grid>
    </Grid>
</Window>
