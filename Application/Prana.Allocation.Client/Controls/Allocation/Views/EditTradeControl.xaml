<UserControl x:Class="Prana.Allocation.Client.Controls.Allocation.Views.EditTradeControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:viewModels="clr-namespace:Prana.Allocation.Client.Controls.Allocation.ViewModels"             
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:themes="http://infragistics.com/Themes"
             xmlns:behaviors="clr-namespace:Prana.Allocation.Client.Controls.Allocation.Behaviours"
             xmlns:commonbehaviors="clr-namespace:Prana.Allocation.Client.Behaviours"
             xmlns:Converters="clr-namespace:Prana.Allocation.Client.ValueConvertor"  
             xmlns:Custom="http://infragistics.com/Editors"
             xmlns:igWPF="http://schemas.infragistics.com/xaml/wpf"
             xmlns:ig="http://schemas.infragistics.com/xaml"
             xmlns:Core="clr-namespace:System;assembly=mscorlib" 
             mc:Ignorable="d"
             DataContext="{DynamicResource EditTradeControlViewModel}" Background="{DynamicResource UserControlBackGround}">
    <UserControl.Resources>
        <ResourceDictionary>
            <!--<ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Prana.Allocation.Client;component/NirvanaSkin.xaml"/>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamComboEditor.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamDockManager.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamEditors.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamGrid.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMenu.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMultiColumnCombo.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>

            </ResourceDictionary.MergedDictionaries>-->

            <viewModels:EditTradeControlViewModel x:Key="EditTradeControlViewModel"/>
            <Converters:PrecisionFormatDisplayConverter x:Key="PrecisionFormatDisplayConverter"/>
            <Style x:Key="NumericEditorStyle" TargetType="{x:Type Custom:XamNumericEditor}">
                <Setter Property="ValueToDisplayTextConverter" Value="{StaticResource PrecisionFormatDisplayConverter}"/>
                <Setter Property="Tag" Value="{Binding Path=PrecisionFormat}"></Setter>
                <Setter Property="Mask" Value="{}{char:15:0-9.}"/>
                <Setter Property="PromptChar" Value=""/>
                <Setter Property="Margin" Value="5,5,5,5"/>
                <Setter Property="MinWidth" Value="100"/>
            </Style>
            <Style x:Key="NegativeNumericEditorStyle" TargetType="{x:Type Custom:XamNumericEditor}">
                <Setter Property="ValueToDisplayTextConverter" Value="{StaticResource PrecisionFormatDisplayConverter}"/>
                <Setter Property="Tag" Value="{Binding Path=PrecisionFormat}"></Setter>
                <Setter Property="Mask" Value="{}{char:15:-0-9.}"/>
                <Setter Property="PromptChar" Value=""/>
                <Setter Property="Margin" Value="5,5,5,5"/>
                <Setter Property="MinWidth" Value="100"/>
            </Style>
            <Style x:Key="QtyColumnPrecision" TargetType="{x:Type Custom:XamNumericEditor}">
                <Setter Property="ValueToDisplayTextConverter" Value="{StaticResource PrecisionFormatDisplayConverter}"/>
                <Setter Property="Tag" Value="{Binding Path=QtyPrecisionFormat}"></Setter>
                <Setter Property="Mask" Value="{}{char:15:0-9.}"/>
                <Setter Property="PromptChar" Value=""/>
                <Setter Property="Margin" Value="5,5,5,5"/>
                <Setter Property="MinWidth" Value="100"/>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <ScrollViewer VerticalAlignment="Stretch" HorizontalAlignment="Stretch" HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <GroupBox Header="Basic Details" Grid.Row="0"  IsEnabled="{Binding Path=IsEnabledBasicFields, Mode=TwoWay}">
                        <Expander IsExpanded="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" MinWidth="150"/>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Content="Symbol:" Grid.Column="0" Grid.Row="0" Margin="5,5,5,5"/>
                                <Label Content="Asset:" Grid.Column="0" Grid.Row="1" Margin="5,5,5,5"/>
                                <Label Content="Executed Qty:" Grid.Column="0" Grid.Row="2" Margin="5,5,5,5"/>
                                <Label Content="Avg Price:" Grid.Column="0" Grid.Row="3" Margin="5,5,5,5"/>
                                <Label Content="Side:" Grid.Column="0" Grid.Row="4" Margin="5,5,5,5"/>
                                <Label Content="Trade Date:" Grid.Column="0" Grid.Row="5" Margin="5,5,5,5"/>
                                <Label Content="Process Date:" Grid.Column="0" Grid.Row="6" Margin="5,5,5,5"/>
                                <Label Content="Original Purchase Date:" Grid.Column="0" Grid.Row="7" Margin="5,5,5,5"/>
                                <Label Content="Settlement Date:" Grid.Column="0" Grid.Row="8" Margin="5,5,5,5"/>
                                <TextBox Name="tbSymbol" Text="{Binding Path=ModifiedGroup.Symbol, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="0" Margin="5,5,5,5" MinWidth="100" IsReadOnly="True" IsEnabled="False"/>
                                <TextBox Name="tbAssetName" Text="{Binding Path=ModifiedGroup.AssetName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="1" Margin="5,5,5,5" MinWidth="100" IsReadOnly="True" IsEnabled="False"/>
                                <Custom:XamNumericEditor x:Name="CumQty" Value="{Binding Path=ModifiedGroup.CumQty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="2" ValueType="Core:Double" IsEnabled="{Binding Path=IsEnabledControl, Mode=TwoWay}" Style="{StaticResource QtyColumnPrecision}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior/>
                                    </i:Interaction.Behaviors>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="EditModeEnded">
                                            <i:InvokeCommandAction Command="{Binding Path=DataContext.UpdateValues, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CommandParameter="CumQuantity"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="AvgPrice"  Value="{Binding Path=ModifiedGroup.AvgPrice, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="3" ValueType="Core:Double"  Style="{StaticResource NumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior/>
                                    </i:Interaction.Behaviors>
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="EditModeEnded">
                                            <i:InvokeCommandAction Command="{Binding Path=DataContext.UpdateValues, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CommandParameter="AvgPrice"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </Custom:XamNumericEditor>
                                <ComboBox x:Name="OrderSideCombo" Text="{Binding Path=ModifiedGroup.OrderSide, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="{Binding SelectedItem.Value, RelativeSource={RelativeSource Self}}"  Grid.Column="1" Grid.Row="4" Margin="5,5,5,5" MinWidth="100" IsEditable="True" IsReadOnly="True" ItemsSource="{Binding Path=Sides}" DisplayMemberPath="Value" SelectedItem="{Binding Path=SelectedSide, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Path=IsEnabledControl, Mode=TwoWay}" Template="{DynamicResource ComboBoxEditableTemplate}">
                                    <ComboBox.ItemContainerStyle>
                                        <Style>
                                            <Setter Property="Control.ToolTip" Value="{Binding Value}" />
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                    </ComboBox>
                                <igWPF:XamDateTimeEditor x:Name="TradeDateTimeEditor" Grid.Column="1" Grid.Row="5" Margin="5,5,5,5" MinWidth="100" Validation.ErrorTemplate="{x:Null}" AutoFillDate="MonthAndYear" Text="{Binding Path=ModifiedGroup.AUECLocalDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Path=IsEnabledControl, Mode=TwoWay}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="EditModeEnded">
                                            <i:InvokeCommandAction Command="{Binding Path=DataContext.UpdateValues, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CommandParameter="TradeDate"/>
                                        </i:EventTrigger>
                                        <i:EventTrigger EventName="ValueChanged">
                                            <i:InvokeCommandAction Command="{Binding Path=DataContext.TradeDateChanged, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CommandParameter="TradeDate"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </igWPF:XamDateTimeEditor>
                                <igWPF:XamDateTimeEditor x:Name="ProcessDateEditor" Grid.Column="1" Grid.Row="6" Margin="5,5,5,5" MinWidth="100" Validation.ErrorTemplate="{x:Null}" AutoFillDate="MonthAndYear" Text="{Binding Path=ModifiedGroup.ProcessDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Path=IsEnabledControl, Mode=TwoWay}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="EditModeEnded">
                                            <i:InvokeCommandAction Command="{Binding Path=DataContext.UpdateValues, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CommandParameter="ProcessDate"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </igWPF:XamDateTimeEditor>
                                <igWPF:XamDateTimeEditor x:Name="OriginalPurchaseDateEditor" Grid.Column="1" Grid.Row="7" Margin="5,5,5,5" MinWidth="100" Validation.ErrorTemplate="{x:Null}" AutoFillDate="MonthAndYear" Text="{Binding Path=ModifiedGroup.OriginalPurchaseDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Path=IsEnabledControl, Mode=TwoWay}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="EditModeEnded">
                                            <i:InvokeCommandAction Command="{Binding Path=DataContext.UpdateValues, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CommandParameter="OriginalPurchaseDate"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </igWPF:XamDateTimeEditor>
                                <igWPF:XamDateTimeEditor x:Name="SettlementDateEditor" Grid.Column="1" Grid.Row="8" Margin="5,5,5,5" MinWidth="100" Validation.ErrorTemplate="{x:Null}" AutoFillDate="MonthAndYear" Text="{Binding Path=ModifiedGroup.SettlementDate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Path=IsEnabledControl, Mode=TwoWay}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="EditModeEnded">
                                            <i:InvokeCommandAction Command="{Binding Path=DataContext.UpdateValues, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" CommandParameter="SettlementDate"/>
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </igWPF:XamDateTimeEditor>
                            </Grid>
                        </Expander>
                    </GroupBox>
                    <GroupBox Header="Commission and Fees" Grid.Row="1">
                        <Expander IsExpanded="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" MinWidth="150"/>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Content="Total Comm and Fees:" Grid.Column="0" Grid.Row="0" Margin="5,5,5,5"/>
                                <Label Content="Commission:" Grid.Column="0" Grid.Row="1" Margin="5,5,5,5"/>
                                <Label Content="Soft Commission:" Grid.Column="0" Grid.Row="3" Margin="5,5,5,5"/>
                                <Label Content="Other Broker Fees:" Grid.Column="0" Grid.Row="4" Margin="5,5,5,5"/>
                                <Label Content="Clearing Broker Fees:" Grid.Column="0" Grid.Row="5" Margin="5,5,5,5"/>
                                <Label Content="Stamp Duty:" Grid.Column="0" Grid.Row="6" Margin="5,5,5,5"/>
                                <Label Content="Transcation Levy:" Grid.Column="0" Grid.Row="7" Margin="5,5,5,5"/>
                                <Label Content="AUEC Fee1:" Grid.Column="0" Grid.Row="8" Margin="5,5,5,5"/>
                                <Label Content="Tax on Comm:" Grid.Column="0" Grid.Row="9" Margin="5,5,5,5"/>
                                <Label Content="AUEC Fee2:" Grid.Column="0" Grid.Row="10" Margin="5,5,5,5"/>
                                <Label Content="SEC Fee:" Grid.Column="0" Grid.Row="11" Margin="5,5,5,5"/>
                                <Label Content="OCC Fee:" Grid.Column="0" Grid.Row="12" Margin="5,5,5,5"/>
                                <Label Content="ORF Fee:" Grid.Column="0" Grid.Row="13" Margin="5,5,5,5"/>
                                <Custom:XamNumericEditor x:Name="TotalCommissionandFees" Value="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="0" IsReadOnly="True" IsEnabled="False" Style="{StaticResource NegativeNumericEditorStyle}"/>
                                <Custom:XamNumericEditor x:Name="Commission" Value="{Binding Path=ModifiedGroup.Commission, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="1" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="SoftCommission" Value="{Binding Path=ModifiedGroup.SoftCommission, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="3" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="OtherBrokerFees" Value="{Binding Path=ModifiedGroup.OtherBrokerFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="4" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="ClearingBrokerFee" Value="{Binding Path=ModifiedGroup.ClearingBrokerFee, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="5" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="StampDuty" Value="{Binding Path=ModifiedGroup.StampDuty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="6" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="TransactionLevy" Value="{Binding Path=ModifiedGroup.TransactionLevy, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="7" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="ClearingFee" Value="{Binding Path=ModifiedGroup.ClearingFee, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="8" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="TaxOnCommissions" Value="{Binding Path=ModifiedGroup.TaxOnCommissions, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="9" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="MiscFees" Value="{Binding Path=ModifiedGroup.MiscFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="10" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="SecFee" Value="{Binding Path=ModifiedGroup.SecFee, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="11" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="OccFee" Value="{Binding Path=ModifiedGroup.OccFee, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="12" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <Custom:XamNumericEditor x:Name="OrfFee" Value="{Binding Path=ModifiedGroup.OrfFee, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="13" ValueType="Core:Double" Style="{StaticResource NegativeNumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior TotalCommissionAndFees="{Binding Path=TotalCommissionAndFees, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ModifiedGroup="{Binding Path=ModifiedGroup, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                            </Grid>
                        </Expander>
                    </GroupBox>
                    <GroupBox Header="Other Details" Grid.Row="2">
                        <Expander IsExpanded="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" MinWidth="150"/>
                                    <ColumnDefinition Width="*" MinWidth="100"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <Label Content="Broker:" Grid.Column="0" Grid.Row="0" Margin="5,5,5,5"/>
                                <Label Content="Venue:" Grid.Column="0" Grid.Row="1" Margin="5,5,5,5"/>
                                <Label Content="Description:" Grid.Column="0" Grid.Row="2" Margin="5,5,5,5"/>
                                <Label Content="Internal Comments:" Grid.Column="0" Grid.Row="3" Margin="5,5,5,5"/>
                                <Label Content="Fx Rate:" Grid.Column="0" Grid.Row="4" Margin="5,5,5,5"/>
                                <Label Content="Fx Conv Operator:" Grid.Column="0" Grid.Row="5" Margin="5,5,5,5"/>
                                <Label Content="Accrued Interest:" Grid.Column="0" Grid.Row="6" Margin="5,5,5,5"/>
                                <Label Content="Settlement Currency:" Grid.Column="0" Grid.Row="7" Margin="5,5,5,5"/>
                                <ComboBox x:Name="CounterPartyNameCombo" Text="{Binding Path=ModifiedGroup.CounterPartyName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="{Binding SelectedItem.Value, RelativeSource={RelativeSource Self}}" Grid.Column="1" Grid.Row="0" Margin="5,5,5,5" MinWidth="100" IsEditable="True" IsReadOnly="True" ItemsSource="{Binding Path=CounterParty}" DisplayMemberPath="Value" SelectedItem="{Binding Path=SelectedCounterParty, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Template="{DynamicResource ComboBoxEditableTemplate}">
                                    <ComboBox.ItemContainerStyle>
                                        <Style>
                                            <Setter Property="Control.ToolTip" Value="{Binding Value}" />
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>
                                <ComboBox x:Name="VenueCombo" Text="{Binding Path=ModifiedGroup.Venue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="{Binding SelectedItem.Value, RelativeSource={RelativeSource Self}}" Grid.Column="1" Grid.Row="1" Margin="5,5,5,5" MinWidth="100" IsEditable="True" IsReadOnly="True" ItemsSource="{Binding Path=Venues}" DisplayMemberPath="Value" SelectedItem="{Binding Path=Venue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Template="{DynamicResource ComboBoxEditableTemplate}">
                                    <ComboBox.ItemContainerStyle>
                                        <Style>
                                            <Setter Property="Control.ToolTip" Value="{Binding Value}" />
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>
                                <TextBox x:Name="Description" Text="{Binding Path=ModifiedGroup.Description, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="2" Margin="5,5,5,5" MinWidth="100"/>
                                <TextBox x:Name="InternalComments" Text="{Binding Path=ModifiedGroup.InternalComments, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="3" Margin="5,5,5,5" MinWidth="100"/>
                                <Custom:XamNumericEditor x:Name="FXRate" Value="{Binding Path=ModifiedGroup.FXRate, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="4" ValueType="Core:Double" IsEnabled="{Binding Path=EnableCurrencyDependencies, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Style="{StaticResource NumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <ComboBox x:Name="FXConversionMethodOperatorCombo" Text="{Binding Path=ModifiedGroup.FXConversionMethodOperator, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ToolTip="{Binding SelectedItem.DisplayText, RelativeSource={RelativeSource Self}}" Grid.Column="1" Grid.Row="5" Margin="5,5,5,5" MinWidth="100" IsEditable="True" IsReadOnly="True"  ItemsSource="{Binding Path=FxConversionOperator}" DisplayMemberPath="DisplayText" SelectedItem="{Binding Path=SelectedFxConversionOperator, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding Path=EnableCurrencyDependencies, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Template="{DynamicResource ComboBoxEditableTemplate}">
                                    <ComboBox.ItemContainerStyle>
                                        <Style>
                                            <Setter Property="Control.ToolTip" Value="{Binding DisplayText}" />
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>
                                <Custom:XamNumericEditor x:Name="AccruedInterest" Value="{Binding Path=ModifiedGroup.AccruedInterest, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="6" IsEnabled="{Binding Path=IsEnabledAccruedInterest, Mode=TwoWay}" ValueType="Core:Double" Style="{StaticResource NumericEditorStyle}">
                                    <i:Interaction.Behaviors>
                                        <behaviors:EditTradeNumericEditorBehavior/>
                                    </i:Interaction.Behaviors>
                                </Custom:XamNumericEditor>
                                <ComboBox x:Name="SettlementCurrencyIDCombo" Text="{Binding Value}"  ToolTip="{Binding SelectedItem.Value, RelativeSource={RelativeSource Self}}" ItemsSource="{Binding Path=SettlCurrency}" DisplayMemberPath="Value" SelectedValuePath="Key" SelectedValue="{Binding Path=ModifiedGroup.SettlementCurrencyID}" IsEnabled="{Binding Path=EnableCurrencyDependencies, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" Grid.Column="1" Grid.Row="7" Margin="5,5,5,5" MinWidth="100" IsEditable="True" IsReadOnly="True" Template="{DynamicResource ComboBoxEditableTemplate}">
                                    <ComboBox.ItemContainerStyle>
                                        <Style>
                                            <Setter Property="Control.ToolTip" Value="{Binding Value}" />
                                        </Style>
                                    </ComboBox.ItemContainerStyle>
                                </ComboBox>
                            </Grid>
                        </Expander>
                    </GroupBox>
                    <GroupBox Header="Trade Attributes" Grid.Row="3">
                        <Expander IsExpanded="True">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto" MinWidth="150"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                <ItemsControl Grid.Column="0" Grid.Row="0" ItemsSource="{Binding AllTradeAttributes}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <UniformGrid Columns="3" Rows="15"/>
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                </Grid.ColumnDefinitions>
                                                <Label Content="{Binding Label}" Grid.Column="0" Margin="5,5,5,5"/>
                                                <ig:XamComboEditor AutomationProperties.AutomationId="{Binding CmbAutomationName}" AutomationProperties.Name="{Binding CmbAutomationName}" 
                                                                   Grid.Column="1" Width="100" Margin="5" IsEditable="True" HorizontalAlignment="Right" MultiSelectValueDelimiter="|"
                                                                   CustomValueEnteredAction="{Binding CustomValueEnteredAction, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}" 
                                                                   SelectedItem="{Binding SelectedValue, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                                                   IsEnabled="{Binding IsEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                                   ItemsSource="{Binding Values, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                    <i:Interaction.Behaviors>
                                                        <commonbehaviors:CustomValueXamComboEditorBehavior />
                                                    </i:Interaction.Behaviors>
                                                </ig:XamComboEditor>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </Grid>
                        </Expander>
                    </GroupBox>
                </Grid>
            </ScrollViewer>
        </Grid>
        <Grid Grid.Row="1" Height="35">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Button x:Name="btnApply" Content="Apply" Grid.Column="1" Margin="25,5,25,5" MinWidth="75" Template="{DynamicResource GreenButtonSkinTemplate}" Foreground="{DynamicResource ButtonForeground}" IsEnabled="{Binding Path=IsEnabledButtons, Mode=TwoWay}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="Click">
                        <i:InvokeCommandAction Command="{Binding Path=ApplyButtonClicked }"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </Button>
            <Button x:Name="btnCancel" Content="Cancel" Grid.Column="2" Margin="25,5,25,5" MinWidth="75" Template="{DynamicResource RedButtonSkinTemplate}" Foreground="{DynamicResource ButtonForeground}" IsEnabled="{Binding Path=IsEnabledButtons, Mode=TwoWay}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="Click">
                        <i:InvokeCommandAction Command="{Binding Path=CancelButtonClicked }"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </Button>
        </Grid>
    </Grid>
    
</UserControl>
