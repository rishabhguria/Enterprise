<?xml version="1.0" encoding="UTF-8"?>
<!--
This file was generated by Altova MapForce 2007

YOU SHOULD NOT MODIFY THIS FILE, BECAUSE IT WILL BE
OVERWRITTEN WHEN YOU RE-RUN CODE GENERATION.

Refer to the Altova MapForce 2007 Documentation for further details.
http://www.altova.com/mapforce
-->
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xs="http://www.w3.org/2001/XMLSchema" exclude-result-prefixes="xs">
  <xsl:output method="xml" encoding="UTF-8" indent="yes"/>
  <xsl:template match="/DocumentElement">
    <DocumentElement>
      <xsl:attribute name="xsi:noNamespaceSchemaLocation">C:/UpdatedTP/ThirdPartyOne_Final.xsd</xsl:attribute>
      <xsl:for-each select="EMSTrades">
        <EMSTrades>

          <!--   SIDE -->
          <xsl:if test="COL1='B'">
            <Side>
              <xsl:value-of select="'Buy'"/>
            </Side>
          </xsl:if>
          <xsl:if test="COL1='S'">
            <Side>
              <xsl:value-of select="'Sell'"/>
            </Side>
          </xsl:if>
          <xsl:if test="COL1='SS'">
            <Side>
              <xsl:value-of select="'Sell short'"/>
            </Side>
          </xsl:if>
          <xsl:if test="COL1='BTO'">
            <Side>
              <xsl:value-of select="'Buy To Open'"/>
            </Side>
          </xsl:if>
          <xsl:if test="COL1='BTC'">
            <Side>
              <xsl:value-of select="'Buy To Close'"/>
            </Side>
          </xsl:if>
          <!--  END  SIDE -->

          <!--<xsl:value-of select="translate(COL3,'&quot;','')"/>   //6,7,10,11,17-->

          <!--<RIC>
            <xsl:value-of select="COL2"/>
          </RIC>-->
          <RIC>
            <xsl:value-of select="COL3"/>
          </RIC>
          <Cusip>
            <xsl:value-of select="COL4"/>
          </Cusip>
          <ISIN>
            <xsl:value-of select="COL5"/>
          </ISIN>
          <OrderID>
            <xsl:value-of select="COL6"/>
          </OrderID>

          <OrderQty>
            <xsl:value-of select="COL7"/>
          </OrderQty>

          <Price>
            <xsl:value-of select="COL8"/>
          </Price>

          <ServerTime>
            <xsl:value-of select="COL9"/>
          </ServerTime>

          <ExecutionID>
            <xsl:value-of select="COL10"/>
          </ExecutionID>


          <ExecutionPrice>
            <xsl:value-of select="COL11"/>
          </ExecutionPrice>


          <ExecutionQty>
            <xsl:value-of select="COL12"/>
          </ExecutionQty>

          <ExecutionTime>
            <xsl:value-of select="COL13"/>
          </ExecutionTime>
          <!--broker is used for counterparty as well as venue...we need to sort that if 
          some mapping is needed or hardcoding would do
          -->
          <xsl:if test="COL14='MSCO'">
            <CounterParty>
              <xsl:value-of select="'MS'"/>
            </CounterParty>
          </xsl:if>
          <xsl:if test="COL14='MSCO'">
            <Venue>
              <xsl:value-of select="'NASDAQ'"/>
            </Venue>
          </xsl:if>

          <xsl:if test="COL15='JSGULBRANDSEN@GCCAPITAL.COM'">
            <TradingAccount>
              <xsl:value-of select="'11'"/>
            </TradingAccount>
          </xsl:if>
          
          <Currency>
            <xsl:value-of select="COL16"/>
          </Currency>

          <StrikePrice>
            <xsl:value-of select="COL17"/>
          </StrikePrice>

          <xsl:variable name = "varExpirationDate" >
            <xsl:value-of select="translate(COL18,'&quot;','')"/>
          </xsl:variable>
          <ExpirationDate>
            <xsl:value-of select="$varExpirationDate"/>
          </ExpirationDate>


          <xsl:variable name = "varPutCall" >
            <xsl:value-of select="translate(COL19,'&quot;','')"/>
          </xsl:variable>
          <PutCallIndicator>
            <xsl:value-of select="$varPutCall"/>
          </PutCallIndicator>



        </EMSTrades>
      </xsl:for-each>
    </DocumentElement>
  </xsl:template>
</xsl:stylesheet>
