<UserControl
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"  
             xmlns:viewModels="clr-namespace:Prana.Allocation.Client.Controls.Preferences.ViewModels"
             xmlns:themes="http://infragistics.com/Themes"
	         xmlns:igEditors="http://infragistics.com/Editors"
             xmlns:igWPF="http://schemas.infragistics.com/xaml/wpf" 
	         xmlns:Custom="http://infragistics.com/DataPresenter" xmlns:commonBehaviours="clr-namespace:Prana.Allocation.Client.Behaviours" xmlns:igExcelExporter="http://infragistics.com/ExcelExporter" x:Class="Prana.Allocation.Client.Controls.Preferences.Views.MasterFundRatioControl"
	         mc:Ignorable="d"
             DataContext="{DynamicResource MasterFundRatioControlViewModel}" Background="{DynamicResource UserControlBackGround}">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Prana.Allocation.Client;component/NirvanaSkin.xaml"/>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamComboEditor.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamDockManager.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamEditors.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamGrid.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMenu.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMultiColumnCombo.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
            </ResourceDictionary.MergedDictionaries>
            <igExcelExporter:DataPresenterExcelExporter x:Key="Exporter"/>
            <viewModels:MasterFundRatioControlViewModel x:Key="MasterFundRatioControlViewModel"/>
            <Style  TargetType="{x:Type igEditors:XamNumericEditor}">
                <Setter Property="Mask" Value="{}{char:15:0-9.}"/>
                <Setter Property="PromptChar" Value=""/>
                <Setter Property="NullText" Value="0"/>
            </Style>
            <Style TargetType="{x:Type igWPF:CellValuePresenter}">
                <Setter Property="BorderThickness" Value="0,0,1,1"/>
                <Setter Property="BorderBrush" Value="Black"/>
            </Style>
            <Style TargetType="{x:Type igWPF:SummaryResultPresenter}">
                <Setter Property="HorizontalAlignment" Value="Right" />
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Custom:XamDataGrid Grid.Row="0" Name="MasterFundRatioDataGrid" DataSource="{Binding Path=MasterFundRatioCollection, Mode=TwoWay}" SelectedDataItem="{Binding Path=SelectedMasterFundItem,  Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" GroupByAreaLocation="None" ScrollingMode="Immediate" IsEnabled="{Binding Path=IsMasterFundAllocationEnable}" ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto" VerticalAlignment="Stretch" HorizontalAlignment="Stretch" Background="#FFE7E8E9">
            <Custom:XamDataGrid.FieldLayouts>
                <Custom:FieldLayout>
                    
                    <Custom:Field Name="MasterFundName" AllowEdit="False" Label="Master Fund"/>
                    <Custom:Field Name="TargetRatioPct" AllowEdit="True" Label="Target Percentage" EditorStyle="{StaticResource {x:Type igEditors:XamNumericEditor}}"/>
                    <Custom:Field Name="CompanyMasterFundID" Visibility="Collapsed"/>
                    <Custom:FieldLayout.SummaryDefinitions>

                        <Custom:SummaryDefinition SourceFieldName="MasterFundName" Calculator="{x:Static Custom:SummaryCalculator.Sum}" DisplayArea="BottomFixed" StringFormat="{} Total: " TextBlock.TextAlignment="Right" />
                        <Custom:SummaryDefinition SourceFieldName="TargetRatioPct" Calculator="{x:Static Custom:SummaryCalculator.Sum}" DisplayArea="BottomFixed" StringFormat="{} {0:0.###########}" TextBlock.TextAlignment="Right"/>
                    </Custom:FieldLayout.SummaryDefinitions>
                    
                </Custom:FieldLayout>
            </Custom:XamDataGrid.FieldLayouts>
            <i:Interaction.Triggers>
                <i:EventTrigger EventName="EditModeEnded">
                    <i:InvokeCommandAction Command="{Binding EditModeEnd}" CommandParameter="{Binding Path=ActiveDataItem, RelativeSource={RelativeSource AncestorType={x:Type Custom:XamDataGrid}}}"/>
                </i:EventTrigger>
                <i:EventTrigger EventName="CellUpdated">
                    <i:InvokeCommandAction Command="{Binding Path=MasterFundGridCellUpdated, Mode=TwoWay}" CommandParameter="{Binding Path=ActiveDataItem, RelativeSource={RelativeSource AncestorType={x:Type Custom:XamDataGrid}}}"/>
                </i:EventTrigger>
            </i:Interaction.Triggers>
            <i:Interaction.Behaviors>
                <commonBehaviours:XamDataGridExporter ExportFilePath="{Binding ExportFilePathForAutomation}" ExportGridData="{Binding Path=ExportGrid, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" ExporterResource="{Binding Mode=OneWay, Source={StaticResource Exporter}}" />
            </i:Interaction.Behaviors>
            <Custom:XamDataGrid.FieldLayoutSettings>
                <Custom:FieldLayoutSettings AutoGenerateFields="False" HighlightAlternateRecords="True" RecordSelectorLocation="None" AllowFieldMoving="No"/>
            </Custom:XamDataGrid.FieldLayoutSettings>
        </Custom:XamDataGrid>
        <Label Grid.Row="1" x:Name="lblAllocationRatioSum" Visibility="{Binding Path=OneMFOneSymbolPreferenceVisible}" Content="*Sum of Allocation Ratio should be 100." Margin="5,5,5,5" HorizontalAlignment="Left"/>
    </Grid>
</UserControl>
