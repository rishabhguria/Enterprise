using System;
using System.Collections.Generic;
using System.Xml.Serialization;

namespace Prana.Allocation.Common.Definitions
{
    /// <summary>
    /// Auto Grouping Rules Properties
    /// </summary>
    public class AutoGroupingRules
    {
        #region Properties

        /// <summary>
        /// The Auto Grouping
        /// </summary>
        [XmlAttributeAttribute("AutoGroup")]
        public bool AutoGroup = false;

        /// <summary>
        /// The broker
        /// </summary>
        [XmlAttributeAttribute("Broker")]
        public bool Broker = true;

        /// <summary>
        /// The venue
        /// </summary>
        [XmlAttributeAttribute("SideAndVenue")]
        public bool Venue = true;

        /// <summary>
        /// The buy and BCV
        /// </summary>
        [XmlAttributeAttribute("BuyAndBCV")]
        public bool BuyAndBCV = true;

        /// <summary>
        /// The trading account
        /// </summary>
        [XmlAttributeAttribute("TradingAccount")]
        public bool TradingAccount = true;

        /// <summary>
        /// The asset class
        /// </summary>
        [XmlAttributeAttribute("AssetClass")]
        public bool AssetClass = true;

        /// <summary>
        /// The trade date
        /// </summary>
        [XmlAttributeAttribute("TradeDate")]
        public bool TradeDate = true;

        /// <summary>
        /// The process date
        /// </summary>
        [XmlAttributeAttribute("ProcessDate")]
        public bool ProcessDate = false;

        /// <summary>
        /// The trade attributes1
        /// </summary>
        [XmlAttributeAttribute("TradeAttributes1")]
        public bool TradeAttributes1 = false;

        /// <summary>
        /// The trade attributes2
        /// </summary>
        [XmlAttributeAttribute("TradeAttributes2")]
        public bool TradeAttributes2 = false;

        /// <summary>
        /// The trade attributes3
        /// </summary>
        [XmlAttributeAttribute("TradeAttributes3")]
        public bool TradeAttributes3 = false;

        /// <summary>
        /// The trade attributes4
        /// </summary>
        [XmlAttributeAttribute("TradeAttributes4")]
        public bool TradeAttributes4 = false;

        /// <summary>
        /// The trade attributes5
        /// </summary>
        [XmlAttributeAttribute("TradeAttributes5")]
        public bool TradeAttributes5 = false;

        /// <summary>
        /// The trade attributes6
        /// </summary>
        [XmlAttributeAttribute("TradeAttributes6")]
        public bool TradeAttributes6 = false;

        /// <summary>
        /// The trade attribute 7
        /// </summary>
        [XmlAttribute("TradeAttributes7")]
        public bool TradeAttributes7 = false;

        /// <summary>
        /// The trade attribute 8
        /// </summary>
        [XmlAttribute("TradeAttributes8")]
        public bool TradeAttributes8 = false;

        /// <summary>
        /// The trade attribute 9
        /// </summary>
        [XmlAttribute("TradeAttributes9")]
        public bool TradeAttributes9 = false;

        /// <summary>
        /// The trade attribute 10
        /// </summary>
        [XmlAttribute("TradeAttributes10")]
        public bool TradeAttributes10 = false;

        /// <summary>
        /// The trade attribute 11
        /// </summary>
        [XmlAttribute("TradeAttributes11")]
        public bool TradeAttributes11 = false;

        /// <summary>
        /// The trade attribute 12
        /// </summary>
        [XmlAttribute("TradeAttributes12")]
        public bool TradeAttributes12 = false;

        /// <summary>
        /// The trade attribute 13
        /// </summary>
        [XmlAttribute("TradeAttributes13")]
        public bool TradeAttributes13 = false;

        /// <summary>
        /// The trade attribute 14
        /// </summary>
        [XmlAttribute("TradeAttributes14")]
        public bool TradeAttributes14 = false;

        /// <summary>
        /// The trade attribute 15
        /// </summary>
        [XmlAttribute("TradeAttributes15")]
        public bool TradeAttributes15 = false;

        /// <summary>
        /// The trade attribute 16
        /// </summary>
        [XmlAttribute("TradeAttributes16")]
        public bool TradeAttributes16 = false;

        /// <summary>
        /// The trade attribute 17
        /// </summary>
        [XmlAttribute("TradeAttributes17")]
        public bool TradeAttributes17 = false;

        /// <summary>
        /// The trade attribute 18
        /// </summary>
        [XmlAttribute("TradeAttributes18")]
        public bool TradeAttributes18 = false;

        /// <summary>
        /// The trade attribute 19
        /// </summary>
        [XmlAttribute("TradeAttributes19")]
        public bool TradeAttributes19 = false;

        /// <summary>
        /// The trade attribute 20
        /// </summary>
        [XmlAttribute("TradeAttributes20")]
        public bool TradeAttributes20 = false;

        /// <summary>
        /// The trade attribute 21
        /// </summary>
        [XmlAttribute("TradeAttributes21")]
        public bool TradeAttributes21 = false;

        /// <summary>
        /// The trade attribute 22
        /// </summary>
        [XmlAttribute("TradeAttributes22")]
        public bool TradeAttributes22 = false;

        /// <summary>
        /// The trade attribute 23
        /// </summary>
        [XmlAttribute("TradeAttributes23")]
        public bool TradeAttributes23 = false;

        /// <summary>
        /// The trade attribute 24
        /// </summary>
        [XmlAttribute("TradeAttributes24")]
        public bool TradeAttributes24 = false;

        /// <summary>
        /// The trade attribute 25
        /// </summary>
        [XmlAttribute("TradeAttributes25")]
        public bool TradeAttributes25 = false;

        /// <summary>
        /// The trade attribute 26
        /// </summary>
        [XmlAttribute("TradeAttributes26")]
        public bool TradeAttributes26 = false;

        /// <summary>
        /// The trade attribute 27
        /// </summary>
        [XmlAttribute("TradeAttributes27")]
        public bool TradeAttributes27 = false;

        /// <summary>
        /// The trade attribute 28
        /// </summary>
        [XmlAttribute("TradeAttributes28")]
        public bool TradeAttributes28 = false;

        /// <summary>
        /// The trade attribute 29
        /// </summary>
        [XmlAttribute("TradeAttributes29")]
        public bool TradeAttributes29 = false;

        /// <summary>
        /// The trade attribute 30
        /// </summary>
        [XmlAttribute("TradeAttributes30")]
        public bool TradeAttributes30 = false;

        /// <summary>
        /// The trade attribute 31
        /// </summary>
        [XmlAttribute("TradeAttributes31")]
        public bool TradeAttributes31 = false;

        /// <summary>
        /// The trade attribute 32
        /// </summary>
        [XmlAttribute("TradeAttributes32")]
        public bool TradeAttributes32 = false;

        /// <summary>
        /// The trade attribute 33
        /// </summary>
        [XmlAttribute("TradeAttributes33")]
        public bool TradeAttributes33 = false;

        /// <summary>
        /// The trade attribute 34
        /// </summary>
        [XmlAttribute("TradeAttributes34")]
        public bool TradeAttributes34 = false;

        /// <summary>
        /// The trade attribute 35
        /// </summary>
        [XmlAttribute("TradeAttributes35")]
        public bool TradeAttributes35 = false;

        /// <summary>
        /// The trade attribute 36
        /// </summary>
        [XmlAttribute("TradeAttributes36")]
        public bool TradeAttributes36 = false;

        /// <summary>
        /// The trade attribute 37
        /// </summary>
        [XmlAttribute("TradeAttributes37")]
        public bool TradeAttributes37 = false;

        /// <summary>
        /// The trade attribute 38
        /// </summary>
        [XmlAttribute("TradeAttributes38")]
        public bool TradeAttributes38 = false;

        /// <summary>
        /// The trade attribute 39
        /// </summary>
        [XmlAttribute("TradeAttributes39")]
        public bool TradeAttributes39 = false;

        /// <summary>
        /// The trade attribute 40
        /// </summary>
        [XmlAttribute("TradeAttributes40")]
        public bool TradeAttributes40 = false;

        /// <summary>
        /// The trade attribute 41
        /// </summary>
        [XmlAttribute("TradeAttributes41")]
        public bool TradeAttributes41 = false;

        /// <summary>
        /// The trade attribute 42
        /// </summary>
        [XmlAttribute("TradeAttributes42")]
        public bool TradeAttributes42 = false;

        /// <summary>
        /// The trade attribute 43
        /// </summary>
        [XmlAttribute("TradeAttributes43")]
        public bool TradeAttributes43 = false;

        /// <summary>
        /// The trade attribute 44
        /// </summary>
        [XmlAttribute("TradeAttributes44")]
        public bool TradeAttributes44 = false;

        /// <summary>
        /// The trade attribute 45
        /// </summary>
        [XmlAttribute("TradeAttributes45")]
        public bool TradeAttributes45 = false;

        #endregion

        #region Private Fields

        private static readonly Dictionary<string, Action<AutoGroupingRules, bool>> _attributeSetters =
            new Dictionary<string, Action<AutoGroupingRules, bool>>
            {
                { "TradeAttribute7",  (obj, val) => obj.TradeAttributes7 = val },
                { "TradeAttribute8",  (obj, val) => obj.TradeAttributes8 = val },
                { "TradeAttribute9",  (obj, val) => obj.TradeAttributes9 = val },
                { "TradeAttribute10", (obj, val) => obj.TradeAttributes10 = val },
                { "TradeAttribute11", (obj, val) => obj.TradeAttributes11 = val },
                { "TradeAttribute12", (obj, val) => obj.TradeAttributes12 = val },
                { "TradeAttribute13", (obj, val) => obj.TradeAttributes13 = val },
                { "TradeAttribute14", (obj, val) => obj.TradeAttributes14 = val },
                { "TradeAttribute15", (obj, val) => obj.TradeAttributes15 = val },
                { "TradeAttribute16", (obj, val) => obj.TradeAttributes16 = val },
                { "TradeAttribute17", (obj, val) => obj.TradeAttributes17 = val },
                { "TradeAttribute18", (obj, val) => obj.TradeAttributes18 = val },
                { "TradeAttribute19", (obj, val) => obj.TradeAttributes19 = val },
                { "TradeAttribute20", (obj, val) => obj.TradeAttributes20 = val },
                { "TradeAttribute21", (obj, val) => obj.TradeAttributes21 = val },
                { "TradeAttribute22", (obj, val) => obj.TradeAttributes22 = val },
                { "TradeAttribute23", (obj, val) => obj.TradeAttributes23 = val },
                { "TradeAttribute24", (obj, val) => obj.TradeAttributes24 = val },
                { "TradeAttribute25", (obj, val) => obj.TradeAttributes25 = val },
                { "TradeAttribute26", (obj, val) => obj.TradeAttributes26 = val },
                { "TradeAttribute27", (obj, val) => obj.TradeAttributes27 = val },
                { "TradeAttribute28", (obj, val) => obj.TradeAttributes28 = val },
                { "TradeAttribute29", (obj, val) => obj.TradeAttributes29 = val },
                { "TradeAttribute30", (obj, val) => obj.TradeAttributes30 = val },
                { "TradeAttribute31", (obj, val) => obj.TradeAttributes31 = val },
                { "TradeAttribute32", (obj, val) => obj.TradeAttributes32 = val },
                { "TradeAttribute33", (obj, val) => obj.TradeAttributes33 = val },
                { "TradeAttribute34", (obj, val) => obj.TradeAttributes34 = val },
                { "TradeAttribute35", (obj, val) => obj.TradeAttributes35 = val },
                { "TradeAttribute36", (obj, val) => obj.TradeAttributes36 = val },
                { "TradeAttribute37", (obj, val) => obj.TradeAttributes37 = val },
                { "TradeAttribute38", (obj, val) => obj.TradeAttributes38 = val },
                { "TradeAttribute39", (obj, val) => obj.TradeAttributes39 = val },
                { "TradeAttribute40", (obj, val) => obj.TradeAttributes40 = val },
                { "TradeAttribute41", (obj, val) => obj.TradeAttributes41 = val },
                { "TradeAttribute42", (obj, val) => obj.TradeAttributes42 = val },
                { "TradeAttribute43", (obj, val) => obj.TradeAttributes43 = val },
                { "TradeAttribute44", (obj, val) => obj.TradeAttributes44 = val },
                { "TradeAttribute45", (obj, val) => obj.TradeAttributes45 = val },
            };

        private static readonly Dictionary<string, Func<AutoGroupingRules, bool>> _attributeGetters =
            new Dictionary<string, Func<AutoGroupingRules, bool>>
            {
                { "TradeAttribute7",  (obj) => obj.TradeAttributes7 },
                { "TradeAttribute8",  (obj) => obj.TradeAttributes8 },
                { "TradeAttribute9",  (obj) => obj.TradeAttributes9 },
                { "TradeAttribute10", (obj) => obj.TradeAttributes10 },
                { "TradeAttribute11", (obj) => obj.TradeAttributes11 },
                { "TradeAttribute12", (obj) => obj.TradeAttributes12 },
                { "TradeAttribute13", (obj) => obj.TradeAttributes13 },
                { "TradeAttribute14", (obj) => obj.TradeAttributes14 },
                { "TradeAttribute15", (obj) => obj.TradeAttributes15 },
                { "TradeAttribute16", (obj) => obj.TradeAttributes16 },
                { "TradeAttribute17", (obj) => obj.TradeAttributes17 },
                { "TradeAttribute18", (obj) => obj.TradeAttributes18 },
                { "TradeAttribute19", (obj) => obj.TradeAttributes19 },
                { "TradeAttribute20", (obj) => obj.TradeAttributes20 },
                { "TradeAttribute21", (obj) => obj.TradeAttributes21 },
                { "TradeAttribute22", (obj) => obj.TradeAttributes22 },
                { "TradeAttribute23", (obj) => obj.TradeAttributes23 },
                { "TradeAttribute24", (obj) => obj.TradeAttributes24 },
                { "TradeAttribute25", (obj) => obj.TradeAttributes25 },
                { "TradeAttribute26", (obj) => obj.TradeAttributes26 },
                { "TradeAttribute27", (obj) => obj.TradeAttributes27 },
                { "TradeAttribute28", (obj) => obj.TradeAttributes28 },
                { "TradeAttribute29", (obj) => obj.TradeAttributes29 },
                { "TradeAttribute30", (obj) => obj.TradeAttributes30 },
                { "TradeAttribute31", (obj) => obj.TradeAttributes31 },
                { "TradeAttribute32", (obj) => obj.TradeAttributes32 },
                { "TradeAttribute33", (obj) => obj.TradeAttributes33 },
                { "TradeAttribute34", (obj) => obj.TradeAttributes34 },
                { "TradeAttribute35", (obj) => obj.TradeAttributes35 },
                { "TradeAttribute36", (obj) => obj.TradeAttributes36 },
                { "TradeAttribute37", (obj) => obj.TradeAttributes37 },
                { "TradeAttribute38", (obj) => obj.TradeAttributes38 },
                { "TradeAttribute39", (obj) => obj.TradeAttributes39 },
                { "TradeAttribute40", (obj) => obj.TradeAttributes40 },
                { "TradeAttribute41", (obj) => obj.TradeAttributes41 },
                { "TradeAttribute42", (obj) => obj.TradeAttributes42 },
                { "TradeAttribute43", (obj) => obj.TradeAttributes43 },
                { "TradeAttribute44", (obj) => obj.TradeAttributes44 },
                { "TradeAttribute45", (obj) => obj.TradeAttributes45 },
            };

        #endregion

        #region Public Methods

        /// <summary>
        /// Sets a single trade attribute preference value.
        /// </summary>
        public virtual void SetTradeAttributeValue(string attributeName, bool value)
        {
            if (_attributeSetters.TryGetValue(attributeName, out var setter))
            {
                setter(this, value);
            }
        }

        /// <summary>
        /// Returns all trade attributes preference as a dictionary.
        /// </summary>
        public virtual Dictionary<string, bool> GetTradeAttributesAsDict()
        {
            var attributesArray = new Dictionary<string, bool>();

            foreach (var entry in _attributeGetters)
            {
                attributesArray.Add(entry.Key, entry.Value(this));
            }
            return attributesArray;
        }

        #endregion
    }
}
