<UserControl x:Class="Prana.Rebalancer.RebalancerNew.Views.CustomGroupsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:themes="http://infragistics.com/Themes"
             mc:Ignorable="d"
             x:Name="CustomGroupUserControl"
             xmlns:converters ="clr-namespace:Prana.Rebalancer.Converters"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/Prana.Rebalancer;component/RebalancerNew/Themes/NirvanaSkin.xaml" />
                <!--<ResourceDictionary Source="/Prana.Rebalancer;component/PercentTradingTool/Themes/NirvanaErrorTemplate.xaml" />-->
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Rebalancer;component/RebalancerNew/Themes/IG/IG.xamComboEditor.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Rebalancer;component/RebalancerNew/Themes/IG/DataPresenterIGTheme_Express.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
            </ResourceDictionary.MergedDictionaries>
            <converters:BooleanToVisibileCollapseConverter x:Key="BooleanToVisibilityConverter"/>
            <Style  TargetType="{x:Type Button}">
                <Setter Property="Template" Value="{DynamicResource ButtonControlTemplate}"/>
                <Setter Property="Width" Value="75"/>
                <Setter Property="Height" Value="20"/>
                <Setter Property="Foreground" Value="White"/>
            </Style>
            <DataTemplate x:Key="DisplayTemplate">
                <TextBlock Text="{Binding ItemValue}" ToolTip="{Binding ItemValue}" Width="228">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding Path=Flag}" Value="True">
                                    <Setter Property="Foreground" Value="DarkBlue"/>
                                    <Setter Property="FontWeight" Value="Bold"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </DataTemplate>
            <DataTemplate x:Key="EditTemplate">
                <TextBox  Text="{Binding ItemValue}" IsEnabled="{Binding Flag}" Width="228">
                    <TextBox.ContextMenu>
                        <ContextMenu Opened="ContextMenu_OnOpened">
                            <MenuItem Header="Delete" Command="{Binding DeleteCommand}"/>
                        </ContextMenu>
                    </TextBox.ContextMenu>
                    <TextBox.InputBindings>
                        <KeyBinding Key="Delete" Command="{Binding DataContext.DeleteCommand,ElementName=CustomGroupUserControl}"></KeyBinding>
                    </TextBox.InputBindings>
                </TextBox>
            </DataTemplate>
            <Style TargetType="{x:Type ListBoxItem}" x:Key="ContainerStyleForCustomGroups">
                <Setter Property="ContentTemplate" Value="{StaticResource DisplayTemplate}"/>
                <Style.Triggers>
                    <Trigger  Property ="IsSelected" Value="True">
                        <Setter Property="ContentTemplate" Value="{StaticResource EditTemplate}" />
                    </Trigger>
                </Style.Triggers>
            </Style>
            <Style TargetType="{x:Type ListBoxItem}" x:Key="ContainerStyleForUnAvailableAccounts">
                <Setter Property="Visibility" Value="{Binding Flag, Mode=OneWay,Converter={StaticResource BooleanToVisibilityConverter},ConverterParameter=Reverse}"/>
                <Setter Property="ContentTemplate" >
                    <Setter.Value>
                        <DataTemplate>
                            <TextBlock Text="{Binding ItemValue}" ToolTip="{Binding ItemValue}" Width="240"  />
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style TargetType="{x:Type ListBoxItem}" x:Key="ContainerStyleForAvailableAccounts">
                <Setter Property="Visibility" Value="{Binding Flag, Mode=OneWay,Converter={StaticResource BooleanToVisibilityConverter}}"/>
                <Setter Property="ContentTemplate" >
                    <Setter.Value>
                        <DataTemplate>
                            <TextBlock Text="{Binding ItemValue}" ToolTip="{Binding ItemValue}" Width="240" />
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <StackPanel>
        <Grid HorizontalAlignment="Center" VerticalAlignment="Top">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <GroupBox Header="Add Custom Group" Margin="25" Grid.Row="0" Grid.Column="0" BorderBrush="Black" BorderThickness="2" Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Label x:Name="lblCustomGroup" Content="Custom Group : " Grid.Column="0"/>
                    <TextBox Grid.Column="1" Width="200" Height="22" Text="{Binding CustomGroupName}" x:Name="CustomGroupNameTextBox" />
                    <Button x:Name="btnCustomGroupsAdd" Content="Add" Command="{Binding AddCustomGroupCommand}" CommandParameter="{Binding Text, ElementName=CustomGroupNameTextBox}" IsEnabled = "{Binding ElementName = CustomGroupNameTextBox, Path = Text.Length}"  Grid.Column="2" Width="80" Height="22" Margin="10,0,0,0"/>
                    <Button x:Name="btnCustomGroupsFormat" Content="Format" Command="{Binding OpenFormatCommand}" Grid.Column="3" Width="80" Height="22" Margin="10,0,0,0"/>
                    <Button x:Name="btnCustomGroupsImport" Content="Import" Command="{Binding ImportCommand}" Grid.Column="4" Width="80" Height="22" Margin="10,0,0,0"/>
                </Grid>
            </GroupBox>
            <GroupBox x:Name="gbEditCustomGroups" Header="Edit Custom Groups"  Grid.Row="1" Grid.Column="0" BorderBrush="Black" BorderThickness="2" Padding="10">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <StackPanel Grid.Row="0" Grid.Column="0">
                        <Label x:Name="lblCustomGroups" Content="Custom Groups"></Label>
                        <ListBox x:Name="GroupsListBox" ItemsSource="{Binding CustomGroupsList}" SelectedItem="{Binding SelectedGroup}"  ItemContainerStyle="{StaticResource ContainerStyleForCustomGroups}" Width="260" Height="280"/>
                    </StackPanel>
                    <StackPanel Grid.Row="0"  Grid.Column="1" Margin="30,0,0,0">
                        <Label x:Name="lblAssignedAccounts" Content="Assigned Accounts"></Label>
                        <ListBox ItemsSource="{Binding AccountsList}" x:Name="AssignedList" ItemContainerStyle="{StaticResource ContainerStyleForAvailableAccounts}" SelectionMode="Extended" HorizontalAlignment="Left" Width="260" Height="280" ></ListBox>
                    </StackPanel>
                    <StackPanel Grid.Row="0"  Grid.Column="2" Margin="10,0,10,0" Orientation="Vertical">
                        <Button x:Name="btnMoveToUnassignedList" Height="30"  Width="30" Margin="0,90,0,10" Content="&#xEA47;" IsEnabled="{Binding SelectedItem.Flag,ElementName=GroupsListBox}"
                            FontFamily="/Prana.Rebalancer;component/RebalancerNew/Resources/Font/#Segoe-MDL2-Assets-MetroUI"
                            FontSize="20" HorizontalAlignment="Left" FontWeight="ExtraBold"
                            Command="{Binding MoveToUnassignedCommand}" 
                            CommandParameter="{Binding SelectedItems,ElementName=AssignedList}"/>
                        <Button x:Name="btnMoveToAssignedList" Height="30" Content="&#xE830;" IsEnabled="{Binding SelectedItem.Flag,ElementName=GroupsListBox}"
                            FontFamily="/Prana.Rebalancer;component/RebalancerNew/Resources/Font/#Segoe-MDL2-Assets-MetroUI" 
                            FontSize="20" Command="{Binding MoveToAssignedCommand}" 
                            FontWeight="ExtraBold" Width="30" 
                            CommandParameter="{Binding SelectedItems,ElementName=UnAssignedList}"/>
                    </StackPanel>
                    <StackPanel Grid.Row="0"  Grid.Column="3">
                        <Label  x:Name="lblUnassignedAccounts" Content="UnAssigned Accounts"></Label>
                        <ListBox ItemsSource="{Binding AccountsList}"   x:Name="UnAssignedList" ItemContainerStyle="{StaticResource ContainerStyleForUnAvailableAccounts}" SelectionMode="Extended" Width="260" Height="280" />
                    </StackPanel>
                    <Button x:Name="btnCustomGroupsSave" Grid.Row="1" Command="{Binding SaveCommand}" IsEnabled="{Binding SelectedItem.Flag,ElementName=GroupsListBox}" Grid.ColumnSpan="4" Grid.Column="0" Height="25" Width="100" Content="Save" Margin="0,15,0,0"/>
                </Grid>
            </GroupBox>
        </Grid>
    </StackPanel>
</UserControl>
