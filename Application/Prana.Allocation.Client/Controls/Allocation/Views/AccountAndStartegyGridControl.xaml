<UserControl
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:ig="http://schemas.infragistics.com/xaml"
             x:Class="Prana.Allocation.Client.Controls.Allocation.Views.AccountAndStartegyGridControl" 
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:igPrim="http://schemas.infragistics.com/xaml/primitives"
             xmlns:viewModels="clr-namespace:Prana.Allocation.Client.Controls.Allocation.ViewModels"
             xmlns:behaviours="clr-namespace:Prana.Allocation.Client.Controls.Allocation.Behaviours"
             xmlns:igEditors="http://infragistics.com/Editors"
             xmlns:themes="http://infragistics.com/Themes"
             mc:Ignorable="d"
             DataContext="{DynamicResource AccountAndStrategyGridControlViewModel}" Background="{DynamicResource UserControlBackGround}">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <!--<ResourceDictionary Source="/Prana.Allocation.Client;component/NirvanaSkin.xaml"/>-->
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamComboEditor.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <!--<themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamDockManager.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamEditors.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>-->
                <themes:ResourceWasher WashMode="HueSaturationReplacement">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamGrid.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <!--<themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMenu.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>
                <themes:ResourceWasher WashMode="HueSaturationReplacement" WashColor="#FF6D6D6D">
                    <themes:ResourceWasher.SourceDictionary>
                        <ResourceDictionary Source="/Prana.Allocation.Client;component/Themes/IG/IG.xamMultiColumnCombo.xaml" />
                    </themes:ResourceWasher.SourceDictionary>
                </themes:ResourceWasher>-->

            </ResourceDictionary.MergedDictionaries>
            <viewModels:AccountAndStrategyGridControlViewModel x:Key="AccountAndStrategyGridControlViewModel"/>
            <igPrim:SummaryResultFormatStringValueConverter x:Key="SDFormatStringConverter"></igPrim:SummaryResultFormatStringValueConverter>
            <Style x:Key="SummaryRowCellsStyle" TargetType="igPrim:SummaryRowCellControl">
                <Setter Property="SummaryDisplayTemplate">
                    <Setter.Value>
                        <DataTemplate>
                            <TextBlock HorizontalAlignment="Right" Text="{Binding Converter={StaticResource SDFormatStringConverter}}" />
                        </DataTemplate>
                    </Setter.Value>
                </Setter>
            </Style>
            <Style TargetType="{x:Type igEditors:XamNumericEditor}">
                <Setter Property="Mask" Value="{Binding Path=DataContext.PrecisionFormat, RelativeSource={RelativeSource AncestorType=UserControl}, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                <Setter Property="PromptChar" Value=""/>
                <Setter Property="HorizontalAlignment" Value="Stretch" />
                <Setter Property="TrimFractionalZeros" Value="True" />
            </Style>
            <Style x:Key="FillerColHeader" TargetType="{x:Type igPrim:HeaderCellControl}">
                <Setter Property="Visibility" Value="Collapsed"/>
            </Style>
            <Style x:Key="FillerColCellStyle" TargetType="ig:CellControl">
                <Setter Property="Visibility" Value="Collapsed"/>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <ComboBox x:Name="StrategyCombo" Grid.Column="0" MinWidth="75" Margin="5,5,5,5" IsEditable="True" IsReadOnly="True" ItemsSource="{Binding Path=StartegyList, Mode=TwoWay}" SelectedItem="{Binding Path=SelectedStrategy, Mode=TwoWay}" DisplayMemberPath="Value" IsSynchronizedWithCurrentItem="True" Template="{DynamicResource ComboBoxEditableTemplate}" Visibility="{Binding Path=SearchStrategyVisible, Mode=TwoWay}">
                <ComboBox.ItemContainerStyle>
                <Style>
                    <Setter Property="Control.ToolTip" Value="{Binding Value}" />
                </Style>
                </ComboBox.ItemContainerStyle>
            </ComboBox>
            <Button x:Name="btnSearchStrategy" Content="Search Strategy" Grid.Column="1" Margin="5,5,5,5" Template="{DynamicResource ButtonControlTemplate}" Foreground="{DynamicResource ButtonForeground}" Visibility="{Binding Path=SearchStrategyVisible, Mode=TwoWay}">
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="Click">
                        <i:InvokeCommandAction Command="{Binding Path=SearchStrategyCommand}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
            </Button>
        </Grid>
        <Grid Grid.Row="1">
            <ig:XamGrid ColumnWidth="SizeToHeader" Name="AccountStartegyGrid" ItemsSource="{Binding Path=AccountStartegyTable, Mode=TwoWay}" AutoGenerateColumns="False">
                <ig:XamGrid.SummaryRowSettings>
                    <ig:SummaryRowSettings AllowSummaryRow="Bottom" SummaryScope="ColumnLayout" SummaryExecution="PriorToFilteringAndPaging" Style="{StaticResource SummaryRowCellsStyle}"/>
                </ig:XamGrid.SummaryRowSettings>
                <i:Interaction.Behaviors>
                    <behaviours:AccountAndStartegyGridBehavior CumQuantity="{Binding Path=CumQauntity, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"  
                                            AccountStrategyTable="{Binding Path=AccountStartegyTable, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            UpdatedAccounts="{Binding Path=UpdatedAccounts, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            TargetDic="{Binding Path=TargetDic1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            SelectedStrategyKeyValue="{Binding Path=SelectedStrategyName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            IsRefreshSummary="{Binding Path=IsRefreshSummary, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            PrecisionDigit="{Binding Path=PrecisionDigit, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            TotalTrades="{Binding Path=TotalTrades, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            IsPrefCmbEnabled="{Binding Path=IsPrefCmbEnabled, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            ISPrefSelected="{Binding Path=ISPrefSelected, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            SelectedTrades="{Binding Path=SelectedTrades, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"                                           
                                            IsSaveLayoutAccountAndStartegyGrid="{Binding Path=IsSaveLayoutAccountAndStartegyGrid, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            IsGridEnable="{Binding Path=IsGridEnable, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"    
                                            IsPrefChanged="{Binding Path=IsPrefChanged, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"                                    
                                            IsSortByPercentage="{Binding Path=IsSortByPercentage, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            IsQtyColumnFirst="{Binding Path=IsQtyColumnFirst, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            SetActiveCell="{Binding Path=SetActiveCell}"
                                            OriginalAllocationDic="{Binding Path=OriginalAllocationDic1, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            EndEditModeGrid="{Binding Path=EndEditModeGrid, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"  
                                            IsAccountStrategyGridExport="{Binding Path=ExportAccountAndStrategyGrid, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                            ExportDataPathAutomation="{Binding Path=ExportPathForAutomation, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                </i:Interaction.Behaviors>
                <ig:XamGrid.EditingSettings>
                    <ig:EditingSettings AllowEditing="Cell" IsMouseActionEditingEnabled="SingleClick" IsOnCellActiveEditingEnabled="True" />
                </ig:XamGrid.EditingSettings>
                <ig:XamGrid.ColumnMovingSettings>
                    <ig:ColumnMovingSettings AllowColumnMoving="Indicator"/>
                </ig:XamGrid.ColumnMovingSettings>
                <ig:XamGrid.FixedColumnSettings>
                    <ig:FixedColumnSettings AllowFixedColumns="Indicator"/>
                </ig:XamGrid.FixedColumnSettings>
                <ig:XamGrid.SortingSettings>
                    <ig:SortingSettings AllowSorting="True" FirstSortDirection="Descending"/>
                </ig:XamGrid.SortingSettings>
                <ig:XamGrid.FilteringSettings>
                    <ig:FilteringSettings FilteringScope="ColumnLayout" AllowFiltering="FilterRowTop"></ig:FilteringSettings>
                </ig:XamGrid.FilteringSettings>
                <ig:XamGrid.FillerColumnSettings>
                    <ig:FillerColumnSettings   Style="{StaticResource FillerColCellStyle}" HeaderStyle="{StaticResource FillerColHeader}"/>
                </ig:XamGrid.FillerColumnSettings>
                <ig:XamGrid.Resources>
                    <Style x:Key="DisableEnableCellStyle" TargetType="ig:CellControl"  BasedOn="{StaticResource CellControlStyle}">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding Account_%}" Value="0">
                                <Setter Property="IsEnabled" Value="False"/>
                                <Setter Property="Foreground" Value="Gray"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ig:XamGrid.Resources>
            </ig:XamGrid>
        </Grid>
        <!--<Grid.ContextMenu>
            <ContextMenu Visibility="Visible">
                <MenuItem Header="Save Layout">
                    <i:Interaction.Triggers>
                        <i:EventTrigger EventName="Click">
                            <i:InvokeCommandAction Command="{Binding Path= SaveGridLayout}"/>
                        </i:EventTrigger>
                    </i:Interaction.Triggers>
                </MenuItem>
            </ContextMenu>
        </Grid.ContextMenu>-->
    </Grid>
</UserControl>
